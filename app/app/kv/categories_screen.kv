#:import dp kivy.metrics.dp
#:import sp kivy.metrics.sp

<CategoryItem@ButtonBehavior+BoxLayout>:
    categoryId: 0
    titleText: ""
    kindText: ""
    isIncome: False
    operationsText: ""
    amountText: ""

    orientation: "horizontal"
    size_hint_y: None
    height: dp(74)
    padding: dp(14), dp(12)
    spacing: dp(12)

    on_release: app.root.get_screen("categories").on_category_click(root.categoryId)

    canvas.before:
        Color:
            rgba: 0.12, 0.12, 0.12, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(14), dp(14), dp(14), dp(14)]
        Color:
            rgba: 0.20, 0.20, 0.20, 1
        Line:
            rounded_rectangle: (self.x, self.y, self.width, self.height, dp(14))
            width: 1.0

    # icon circle
    BoxLayout:
        size_hint: None, None
        size: dp(44), dp(44)

        canvas.before:
            Color:
                rgba: (0.10, 0.60, 0.95, 1) if root.isIncome else (0.95, 0.35, 0.20, 1)
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [dp(22), dp(22), dp(22), dp(22)]

        Label:
            text: "üìÅ"
            color: 1, 1, 1, 1
            font_size: sp(16)
            halign: "center"
            valign: "middle"
            text_size: self.size

    # texts
    BoxLayout:
        orientation: "vertical"
        spacing: dp(6)

        Label:
            text: root.titleText
            color: 1, 1, 1, 1
            font_size: sp(14)
            bold: True
            size_hint_y: None
            height: dp(18)
            halign: "left"
            valign: "middle"
            text_size: self.size

        BoxLayout:
            orientation: "horizontal"
            spacing: dp(8)
            size_hint_y: None
            height: dp(18)

            Label:
                text: root.kindText
                color: (0.10, 0.85, 0.55, 1) if root.isIncome else (0.95, 0.20, 0.25, 1)
                font_size: sp(12)
                bold: True
                size_hint_x: None
                width: dp(52)
                halign: "left"
                valign: "middle"
                text_size: self.size

            Label:
                text: root.operationsText + " ‚Ä¢ " + root.amountText
                color: 0.70, 0.70, 0.70, 1
                font_size: sp(12)
                halign: "left"
                valign: "middle"
                text_size: self.size

    # chevron
    Label:
        text: "‚Ä∫"
        color: 0.70, 0.70, 0.70, 1
        font_size: sp(24)
        size_hint_x: None
        width: dp(18)
        halign: "right"
        valign: "middle"
        text_size: self.size


<CategoriesScreen>:
    BoxLayout:
        orientation: "vertical"

        # Top bar
        BoxLayout:
            size_hint_y: None
            height: dp(64)
            padding: dp(16), dp(10)

            Label:
                text: "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"
                color: 1,1,1,1
                font_size: sp(16)
                bold: True
                halign: "center"
                valign: "middle"
                text_size: self.size

            Button:
                text: "+"
                size_hint: None, None
                size: dp(44), dp(44)
                background_normal: ""
                background_color: 0,0,0,0
                color: 0.85,0.85,0.85,1
                on_release: root.on_top_plus_click()

        Widget:
            size_hint_y: None
            height: dp(1)
            canvas.before:
                Color:
                    rgba: 0.15, 0.15, 0.15, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

        # Content
        BoxLayout:
            orientation: "vertical"
            padding: dp(16), dp(14)
            spacing: dp(12)

            Button:
                text: "+    –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"
                size_hint_y: None
                height: dp(54)
                background_normal: ""
                background_color: 0.32, 0.70, 0.98, 1
                color: 0,0,0,1
                font_size: sp(14)
                bold: True
                on_release: root.on_create_category_click()
                canvas.before:
                    Color:
                        rgba: 0.32, 0.70, 0.98, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(14), dp(14), dp(14), dp(14)]

            Label:
                text: root.statusText
                size_hint_y: None
                height: dp(22) if root.statusText else dp(0)
                color: 0.75, 0.75, 0.75, 1
                font_size: sp(12)
                halign: "center"
                valign: "middle"
                text_size: self.size

            RecycleView:
                id: rvCategories
                viewclass: "CategoryItem"
                data: root.rvData

                RecycleBoxLayout:
                    default_size: None, dp(74)
                    default_size_hint: 1, None
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(12)
                    orientation: "vertical"

        # Bottom nav
        Widget:
            size_hint_y: None
            height: dp(1)
            canvas.before:
                Color:
                    rgba: 0.15, 0.15, 0.15, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

        BoxLayout:
            size_hint_y: None
            height: dp(74)
            padding: dp(18), dp(10)
            spacing: dp(18)
            canvas.before:
                Color:
                    rgba: 0.06, 0.06, 0.06, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            Button:
                id: navHome
                text: "‚åÇ\n–ì–ª–∞–≤–Ω–∞—è"
                halign: "center"
                valign: "middle"
                text_size: self.size
                font_size: sp(12)
                background_normal: ""
                background_color: 0,0,0,0
                color: 0.70,0.70,0.70,1
                on_release: root.on_nav_click("home")

            Button:
                id: navTransactions
                text: "‚â°\n–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"
                halign: "center"
                valign: "middle"
                text_size: self.size
                font_size: sp(12)
                background_normal: ""
                background_color: 0,0,0,0
                color: 0.70,0.70,0.70,1
                on_release: root.on_nav_click("transactions")

            Button:
                id: navCategories
                text: "‚ñ¢\n–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"
                halign: "center"
                valign: "middle"
                text_size: self.size
                font_size: sp(12)
                background_normal: ""
                background_color: 0,0,0,0
                color: 0.27,0.62,0.97,1
                on_release: root.on_nav_click("categories")

            Button:
                id: navAnalytics
                text: "‚óî\n–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"
                halign: "center"
                valign: "middle"
                text_size: self.size
                font_size: sp(12)
                background_normal: ""
                background_color: 0,0,0,0
                color: 0.70,0.70,0.70,1
                on_release: root.on_nav_click("analytics")
